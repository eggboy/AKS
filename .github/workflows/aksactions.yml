name: 'aksactions'

on:
  push:
    branches: [ "main" ]
  pull_request:

permissions:
  id-token: write
  contents: read

jobs:
  aksactions:
    name: 'aksactions'
    runs-on: self-hosted
    defaults:
      run:
        shell: bash
    steps:
    - name: Check out repository
      uses: actions/checkout@v3
    - name: 'Azure Login'
      uses: azure/login@v1.4.6
      with:
        creds: ${{ secrets.AZURE_CREDENTIALS }}
    - name: Set AKS context
      id: set-context
      uses: azure/aks-set-context@v3
      with:
        resource-group: 'sandbox-rg'
        cluster-name: 'rbac-cluster'
    - uses: azure/setup-kubectl@v3
      name: Setup kubectl
    - name: Run kubectl
      run: |
        kubectl get pods

